import { serve, serveTLS } from "./vendor/https/deno.land/std/http/server.ts";
import { join } from "./vendor/https/deno.land/std/path/mod.ts";
import { yellow } from "./vendor/https/deno.land/std/fmt/colors.ts";
import { Context } from "./context.ts";
import { Router } from "./router.ts";
import { Group } from "./group.ts";
import { createHttpExceptionBody, HttpException, InternalServerErrorException } from "./http_exception.ts";
export function NotImplemented() {
    return new Error("Not Implemented");
}
/**
 * Hello World.
 *
 *    const app = new Application();
 *
 *    app
 *      .get("/hello", (c) => {
 *        return "Hello, Abc!";
 *      })
 *      .start({ port: 8080 });
 */ export class Application {
    server;
    renderer;
    router = new Router();
    middleware = [];
    premiddleware = [];
    #process;
    #groups = [];
    /** Unstable */ get θprocess() {
        console.warn(yellow("`Application#θprocess` is UNSTABLE!"));
        return this.#process;
    }
    #start = async (s)=>{
        this.server = s;
        for await (const req of this.server){
            const c = new Context({
                r: req,
                app: this
            });
            let h;
            for (const i of this.#groups){
                i.θapplyMiddleware();
            }
            if (this.premiddleware.length === 0) {
                h = this.router.find(req.method, c);
                h = this.#applyMiddleware(h, ...this.middleware);
            } else {
                h = (c)=>{
                    h = this.router.find(req.method, c);
                    h = this.#applyMiddleware(h, ...this.middleware);
                    return h(c);
                };
                h = this.#applyMiddleware(h, ...this.premiddleware);
            }
            this.#transformResult(c, h).then(()=>{
                req.respond(c.response).catch(()=>{
                });
            });
        }
    };
    #applyMiddleware = (h, ...m)=>{
        for(let i = m.length - 1; i >= 0; --i){
            h = m[i](h);
        }
        return h;
    };
    /**
   * Start an HTTP server.
   *
   *    app.start({ port: 8080 });
   */ start(sc) {
        this.#process = this.#start(serve(sc));
    }
    /** Start an HTTPS server. */ startTLS(sc) {
        this.#process = this.#start(serveTLS(sc));
    }
    /**
   * Stop the server immediately.
   *
   *    await app.close();
   */ async close() {
        if (this.server) {
            this.server.close();
        }
        await this.#process;
    }
    /** `pre` adds middleware which is run before router. */ pre(...m) {
        this.premiddleware.push(...m);
        return this;
    }
    /** `use` adds middleware which is run after router. */ use(...m) {
        this.middleware.push(...m);
        return this;
    }
    connect(path, h, ...m) {
        return this.add("CONNECT", path, h, ...m);
    }
    delete(path, h, ...m) {
        return this.add("DELETE", path, h, ...m);
    }
    get(path, h, ...m) {
        return this.add("GET", path, h, ...m);
    }
    head(path, h, ...m) {
        return this.add("HEAD", path, h, ...m);
    }
    options(path, h, ...m) {
        return this.add("OPTIONS", path, h, ...m);
    }
    patch(path, h, ...m) {
        return this.add("PATCH", path, h, ...m);
    }
    post(path, h, ...m) {
        return this.add("POST", path, h, ...m);
    }
    put(path, h, ...m) {
        return this.add("PUT", path, h, ...m);
    }
    trace(path, h, ...m) {
        return this.add("TRACE", path, h, ...m);
    }
    any(path, h, ...m) {
        const methods = [
            "CONNECT",
            "DELETE",
            "GET",
            "HEAD",
            "OPTIONS",
            "PATCH",
            "POST",
            "PUT",
            "TRACE", 
        ];
        for (const method of methods){
            this.add(method, path, h, ...m);
        }
        return this;
    }
    match(methods, path, h, ...m) {
        for (const method of methods){
            this.add(method, path, h, ...m);
        }
        return this;
    }
    add(method, path, handler, ...middleware) {
        this.router.add(method, path, (c)=>{
            let h = handler;
            for (const m of middleware){
                h = m(h);
            }
            return h(c);
        });
        return this;
    }
    /** `group` creates a new router group with prefix and optional group level middleware. */ group(prefix, ...m) {
        const g = new Group({
            app: this,
            prefix
        });
        this.#groups.push(g);
        g.use(...m);
        return g;
    }
    /**
   * Register a new route with path prefix to serve static files from the provided root directory.
   * For example, a request to `/static/js/main.js` will fetch and serve `assets/js/main.js` file.
   *
   *    app.static("/static", "assets");
   */ static(prefix, root, ...m) {
        if (prefix[prefix.length - 1] === "/") {
            prefix = prefix.slice(0, prefix.length - 1);
        }
        const h = (c)=>{
            const filepath = c.path.substr(prefix.length);
            return c.file(join(root, filepath));
        };
        return this.get(`${prefix}/*`, h, ...m);
    }
    /**
   * Register a new route with path to serve a static file with optional route-level middleware.
   *
   *    app.file("/", "public/index.html");
   */ file(path, filepath, ...m) {
        return this.get(path, (c)=>c.file(filepath)
        , ...m);
    }
    #transformResult = async (c, h)=>{
        let result;
        try {
            result = await h(c);
        } catch (e) {
            if (e instanceof HttpException) {
                result = c.json(typeof e.response === "object" ? e.response : createHttpExceptionBody(e.response, undefined, e.status), e.status);
            } else {
                console.log(e);
                e = new InternalServerErrorException(e.message);
                result = c.json(e.response, e.status);
            }
        }
        if (c.response.status == undefined) {
            switch(typeof result){
                case "object":
                    if (result instanceof Uint8Array) {
                        c.blob(result);
                    } else {
                        c.json(result);
                    }
                    break;
                case "string":
                    /^\s*</.test(result) ? c.html(result) : c.string(result);
                    break;
                default:
                    c.string(String(result));
            }
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvYWJjQHYxLjMuMy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBIYW5kbGVyRnVuYywgTWlkZGxld2FyZUZ1bmMsIFJlbmRlcmVyIH0gZnJvbSBcIi4vdHlwZXMudHNcIjtcbmltcG9ydCB0eXBlIHtcbiAgSFRUUE9wdGlvbnMsXG4gIEhUVFBTT3B0aW9ucyxcbiAgU2VydmVyLFxufSBmcm9tIFwiLi92ZW5kb3IvaHR0cHMvZGVuby5sYW5kL3N0ZC9odHRwL3NlcnZlci50c1wiO1xuXG5pbXBvcnQgeyBzZXJ2ZSwgc2VydmVUTFMgfSBmcm9tIFwiLi92ZW5kb3IvaHR0cHMvZGVuby5sYW5kL3N0ZC9odHRwL3NlcnZlci50c1wiO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gXCIuL3ZlbmRvci9odHRwcy9kZW5vLmxhbmQvc3RkL3BhdGgvbW9kLnRzXCI7XG5pbXBvcnQgeyB5ZWxsb3cgfSBmcm9tIFwiLi92ZW5kb3IvaHR0cHMvZGVuby5sYW5kL3N0ZC9mbXQvY29sb3JzLnRzXCI7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSBcIi4vY29udGV4dC50c1wiO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSBcIi4vcm91dGVyLnRzXCI7XG5pbXBvcnQgeyBHcm91cCB9IGZyb20gXCIuL2dyb3VwLnRzXCI7XG5pbXBvcnQge1xuICBjcmVhdGVIdHRwRXhjZXB0aW9uQm9keSxcbiAgSHR0cEV4Y2VwdGlvbixcbiAgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbixcbn0gZnJvbSBcIi4vaHR0cF9leGNlcHRpb24udHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIE5vdEltcGxlbWVudGVkKCk6IEVycm9yIHtcbiAgcmV0dXJuIG5ldyBFcnJvcihcIk5vdCBJbXBsZW1lbnRlZFwiKTtcbn1cblxuLyoqXG4gKiBIZWxsbyBXb3JsZC5cbiAqXG4gKiAgICBjb25zdCBhcHAgPSBuZXcgQXBwbGljYXRpb24oKTtcbiAqXG4gKiAgICBhcHBcbiAqICAgICAgLmdldChcIi9oZWxsb1wiLCAoYykgPT4ge1xuICogICAgICAgIHJldHVybiBcIkhlbGxvLCBBYmMhXCI7XG4gKiAgICAgIH0pXG4gKiAgICAgIC5zdGFydCh7IHBvcnQ6IDgwODAgfSk7XG4gKi9cbmV4cG9ydCBjbGFzcyBBcHBsaWNhdGlvbiB7XG4gIHNlcnZlcjogU2VydmVyIHwgdW5kZWZpbmVkO1xuICByZW5kZXJlcjogUmVuZGVyZXIgfCB1bmRlZmluZWQ7XG4gIHJvdXRlciA9IG5ldyBSb3V0ZXIoKTtcbiAgbWlkZGxld2FyZTogTWlkZGxld2FyZUZ1bmNbXSA9IFtdO1xuICBwcmVtaWRkbGV3YXJlOiBNaWRkbGV3YXJlRnVuY1tdID0gW107XG5cbiAgI3Byb2Nlc3M6IFByb21pc2U8dm9pZD4gfCB1bmRlZmluZWQ7XG4gICNncm91cHM6IEdyb3VwW10gPSBbXTtcblxuICAvKiogVW5zdGFibGUgKi9cbiAgZ2V0IM64cHJvY2VzcygpOiBQcm9taXNlPHZvaWQ+IHwgdW5kZWZpbmVkIHtcbiAgICBjb25zb2xlLndhcm4oeWVsbG93KFwiYEFwcGxpY2F0aW9uI864cHJvY2Vzc2AgaXMgVU5TVEFCTEUhXCIpKTtcbiAgICByZXR1cm4gdGhpcy4jcHJvY2VzcztcbiAgfVxuXG4gICNzdGFydCA9IGFzeW5jIChzOiBTZXJ2ZXIpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICB0aGlzLnNlcnZlciA9IHM7XG5cbiAgICBmb3IgYXdhaXQgKGNvbnN0IHJlcSBvZiB0aGlzLnNlcnZlcikge1xuICAgICAgY29uc3QgYyA9IG5ldyBDb250ZXh0KHtcbiAgICAgICAgcjogcmVxLFxuICAgICAgICBhcHA6IHRoaXMsXG4gICAgICB9KTtcbiAgICAgIGxldCBoOiBIYW5kbGVyRnVuYztcblxuICAgICAgZm9yIChjb25zdCBpIG9mIHRoaXMuI2dyb3Vwcykge1xuICAgICAgICBpLs64YXBwbHlNaWRkbGV3YXJlKCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnByZW1pZGRsZXdhcmUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGggPSB0aGlzLnJvdXRlci5maW5kKHJlcS5tZXRob2QsIGMpO1xuICAgICAgICBoID0gdGhpcy4jYXBwbHlNaWRkbGV3YXJlKGgsIC4uLnRoaXMubWlkZGxld2FyZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBoID0gKGMpID0+IHtcbiAgICAgICAgICBoID0gdGhpcy5yb3V0ZXIuZmluZChyZXEubWV0aG9kLCBjKTtcbiAgICAgICAgICBoID0gdGhpcy4jYXBwbHlNaWRkbGV3YXJlKGgsIC4uLnRoaXMubWlkZGxld2FyZSk7XG4gICAgICAgICAgcmV0dXJuIGgoYyk7XG4gICAgICAgIH07XG4gICAgICAgIGggPSB0aGlzLiNhcHBseU1pZGRsZXdhcmUoaCwgLi4udGhpcy5wcmVtaWRkbGV3YXJlKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy4jdHJhbnNmb3JtUmVzdWx0KGMsIGgpLnRoZW4oKCk6IHZvaWQgPT4ge1xuICAgICAgICByZXEucmVzcG9uZChjLnJlc3BvbnNlKS5jYXRjaCgoKSA9PiB7fSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgI2FwcGx5TWlkZGxld2FyZSA9IChoOiBIYW5kbGVyRnVuYywgLi4ubTogTWlkZGxld2FyZUZ1bmNbXSk6IEhhbmRsZXJGdW5jID0+IHtcbiAgICBmb3IgKGxldCBpID0gbS5sZW5ndGggLSAxOyBpID49IDA7IC0taSkge1xuICAgICAgaCA9IG1baV0oaCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGg7XG4gIH07XG5cbiAgLyoqXG4gICAqIFN0YXJ0IGFuIEhUVFAgc2VydmVyLlxuICAgKlxuICAgKiAgICBhcHAuc3RhcnQoeyBwb3J0OiA4MDgwIH0pO1xuICAgKi9cbiAgc3RhcnQoc2M6IEhUVFBPcHRpb25zKTogdm9pZCB7XG4gICAgdGhpcy4jcHJvY2VzcyA9IHRoaXMuI3N0YXJ0KHNlcnZlKHNjKSk7XG4gIH1cblxuICAvKiogU3RhcnQgYW4gSFRUUFMgc2VydmVyLiAqL1xuICBzdGFydFRMUyhzYzogSFRUUFNPcHRpb25zKTogdm9pZCB7XG4gICAgdGhpcy4jcHJvY2VzcyA9IHRoaXMuI3N0YXJ0KHNlcnZlVExTKHNjKSk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcCB0aGUgc2VydmVyIGltbWVkaWF0ZWx5LlxuICAgKlxuICAgKiAgICBhd2FpdCBhcHAuY2xvc2UoKTtcbiAgICovXG4gIGFzeW5jIGNsb3NlKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICh0aGlzLnNlcnZlcikge1xuICAgICAgdGhpcy5zZXJ2ZXIuY2xvc2UoKTtcbiAgICB9XG4gICAgYXdhaXQgdGhpcy4jcHJvY2VzcztcbiAgfVxuXG4gIC8qKiBgcHJlYCBhZGRzIG1pZGRsZXdhcmUgd2hpY2ggaXMgcnVuIGJlZm9yZSByb3V0ZXIuICovXG4gIHByZSguLi5tOiBNaWRkbGV3YXJlRnVuY1tdKTogQXBwbGljYXRpb24ge1xuICAgIHRoaXMucHJlbWlkZGxld2FyZS5wdXNoKC4uLm0pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqIGB1c2VgIGFkZHMgbWlkZGxld2FyZSB3aGljaCBpcyBydW4gYWZ0ZXIgcm91dGVyLiAqL1xuICB1c2UoLi4ubTogTWlkZGxld2FyZUZ1bmNbXSk6IEFwcGxpY2F0aW9uIHtcbiAgICB0aGlzLm1pZGRsZXdhcmUucHVzaCguLi5tKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGNvbm5lY3QocGF0aDogc3RyaW5nLCBoOiBIYW5kbGVyRnVuYywgLi4ubTogTWlkZGxld2FyZUZ1bmNbXSk6IEFwcGxpY2F0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5hZGQoXCJDT05ORUNUXCIsIHBhdGgsIGgsIC4uLm0pO1xuICB9XG5cbiAgZGVsZXRlKHBhdGg6IHN0cmluZywgaDogSGFuZGxlckZ1bmMsIC4uLm06IE1pZGRsZXdhcmVGdW5jW10pOiBBcHBsaWNhdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkKFwiREVMRVRFXCIsIHBhdGgsIGgsIC4uLm0pO1xuICB9XG5cbiAgZ2V0KHBhdGg6IHN0cmluZywgaDogSGFuZGxlckZ1bmMsIC4uLm06IE1pZGRsZXdhcmVGdW5jW10pOiBBcHBsaWNhdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkKFwiR0VUXCIsIHBhdGgsIGgsIC4uLm0pO1xuICB9XG5cbiAgaGVhZChwYXRoOiBzdHJpbmcsIGg6IEhhbmRsZXJGdW5jLCAuLi5tOiBNaWRkbGV3YXJlRnVuY1tdKTogQXBwbGljYXRpb24ge1xuICAgIHJldHVybiB0aGlzLmFkZChcIkhFQURcIiwgcGF0aCwgaCwgLi4ubSk7XG4gIH1cblxuICBvcHRpb25zKHBhdGg6IHN0cmluZywgaDogSGFuZGxlckZ1bmMsIC4uLm06IE1pZGRsZXdhcmVGdW5jW10pOiBBcHBsaWNhdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkKFwiT1BUSU9OU1wiLCBwYXRoLCBoLCAuLi5tKTtcbiAgfVxuXG4gIHBhdGNoKHBhdGg6IHN0cmluZywgaDogSGFuZGxlckZ1bmMsIC4uLm06IE1pZGRsZXdhcmVGdW5jW10pOiBBcHBsaWNhdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkKFwiUEFUQ0hcIiwgcGF0aCwgaCwgLi4ubSk7XG4gIH1cblxuICBwb3N0KHBhdGg6IHN0cmluZywgaDogSGFuZGxlckZ1bmMsIC4uLm06IE1pZGRsZXdhcmVGdW5jW10pOiBBcHBsaWNhdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkKFwiUE9TVFwiLCBwYXRoLCBoLCAuLi5tKTtcbiAgfVxuXG4gIHB1dChwYXRoOiBzdHJpbmcsIGg6IEhhbmRsZXJGdW5jLCAuLi5tOiBNaWRkbGV3YXJlRnVuY1tdKTogQXBwbGljYXRpb24ge1xuICAgIHJldHVybiB0aGlzLmFkZChcIlBVVFwiLCBwYXRoLCBoLCAuLi5tKTtcbiAgfVxuXG4gIHRyYWNlKHBhdGg6IHN0cmluZywgaDogSGFuZGxlckZ1bmMsIC4uLm06IE1pZGRsZXdhcmVGdW5jW10pOiBBcHBsaWNhdGlvbiB7XG4gICAgcmV0dXJuIHRoaXMuYWRkKFwiVFJBQ0VcIiwgcGF0aCwgaCwgLi4ubSk7XG4gIH1cblxuICBhbnkocGF0aDogc3RyaW5nLCBoOiBIYW5kbGVyRnVuYywgLi4ubTogTWlkZGxld2FyZUZ1bmNbXSk6IEFwcGxpY2F0aW9uIHtcbiAgICBjb25zdCBtZXRob2RzID0gW1xuICAgICAgXCJDT05ORUNUXCIsXG4gICAgICBcIkRFTEVURVwiLFxuICAgICAgXCJHRVRcIixcbiAgICAgIFwiSEVBRFwiLFxuICAgICAgXCJPUFRJT05TXCIsXG4gICAgICBcIlBBVENIXCIsXG4gICAgICBcIlBPU1RcIixcbiAgICAgIFwiUFVUXCIsXG4gICAgICBcIlRSQUNFXCIsXG4gICAgXTtcbiAgICBmb3IgKGNvbnN0IG1ldGhvZCBvZiBtZXRob2RzKSB7XG4gICAgICB0aGlzLmFkZChtZXRob2QsIHBhdGgsIGgsIC4uLm0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIG1hdGNoKFxuICAgIG1ldGhvZHM6IHN0cmluZ1tdLFxuICAgIHBhdGg6IHN0cmluZyxcbiAgICBoOiBIYW5kbGVyRnVuYyxcbiAgICAuLi5tOiBNaWRkbGV3YXJlRnVuY1tdXG4gICk6IEFwcGxpY2F0aW9uIHtcbiAgICBmb3IgKGNvbnN0IG1ldGhvZCBvZiBtZXRob2RzKSB7XG4gICAgICB0aGlzLmFkZChtZXRob2QsIHBhdGgsIGgsIC4uLm0pO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGFkZChcbiAgICBtZXRob2Q6IHN0cmluZyxcbiAgICBwYXRoOiBzdHJpbmcsXG4gICAgaGFuZGxlcjogSGFuZGxlckZ1bmMsXG4gICAgLi4ubWlkZGxld2FyZTogTWlkZGxld2FyZUZ1bmNbXVxuICApOiBBcHBsaWNhdGlvbiB7XG4gICAgdGhpcy5yb3V0ZXIuYWRkKG1ldGhvZCwgcGF0aCwgKGM6IENvbnRleHQpOiB1bmtub3duID0+IHtcbiAgICAgIGxldCBoID0gaGFuZGxlcjtcbiAgICAgIGZvciAoY29uc3QgbSBvZiBtaWRkbGV3YXJlKSB7XG4gICAgICAgIGggPSBtKGgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGgoYyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKiogYGdyb3VwYCBjcmVhdGVzIGEgbmV3IHJvdXRlciBncm91cCB3aXRoIHByZWZpeCBhbmQgb3B0aW9uYWwgZ3JvdXAgbGV2ZWwgbWlkZGxld2FyZS4gKi9cbiAgZ3JvdXAocHJlZml4OiBzdHJpbmcsIC4uLm06IE1pZGRsZXdhcmVGdW5jW10pOiBHcm91cCB7XG4gICAgY29uc3QgZyA9IG5ldyBHcm91cCh7IGFwcDogdGhpcywgcHJlZml4IH0pO1xuICAgIHRoaXMuI2dyb3Vwcy5wdXNoKGcpO1xuICAgIGcudXNlKC4uLm0pO1xuICAgIHJldHVybiBnO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGEgbmV3IHJvdXRlIHdpdGggcGF0aCBwcmVmaXggdG8gc2VydmUgc3RhdGljIGZpbGVzIGZyb20gdGhlIHByb3ZpZGVkIHJvb3QgZGlyZWN0b3J5LlxuICAgKiBGb3IgZXhhbXBsZSwgYSByZXF1ZXN0IHRvIGAvc3RhdGljL2pzL21haW4uanNgIHdpbGwgZmV0Y2ggYW5kIHNlcnZlIGBhc3NldHMvanMvbWFpbi5qc2AgZmlsZS5cbiAgICpcbiAgICogICAgYXBwLnN0YXRpYyhcIi9zdGF0aWNcIiwgXCJhc3NldHNcIik7XG4gICAqL1xuICBzdGF0aWMocHJlZml4OiBzdHJpbmcsIHJvb3Q6IHN0cmluZywgLi4ubTogTWlkZGxld2FyZUZ1bmNbXSk6IEFwcGxpY2F0aW9uIHtcbiAgICBpZiAocHJlZml4W3ByZWZpeC5sZW5ndGggLSAxXSA9PT0gXCIvXCIpIHtcbiAgICAgIHByZWZpeCA9IHByZWZpeC5zbGljZSgwLCBwcmVmaXgubGVuZ3RoIC0gMSk7XG4gICAgfVxuICAgIGNvbnN0IGg6IEhhbmRsZXJGdW5jID0gKGMpID0+IHtcbiAgICAgIGNvbnN0IGZpbGVwYXRoID0gYy5wYXRoLnN1YnN0cihwcmVmaXgubGVuZ3RoKTtcbiAgICAgIHJldHVybiBjLmZpbGUoam9pbihyb290LCBmaWxlcGF0aCkpO1xuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuZ2V0KGAke3ByZWZpeH0vKmAsIGgsIC4uLm0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGEgbmV3IHJvdXRlIHdpdGggcGF0aCB0byBzZXJ2ZSBhIHN0YXRpYyBmaWxlIHdpdGggb3B0aW9uYWwgcm91dGUtbGV2ZWwgbWlkZGxld2FyZS5cbiAgICpcbiAgICogICAgYXBwLmZpbGUoXCIvXCIsIFwicHVibGljL2luZGV4Lmh0bWxcIik7XG4gICAqL1xuICBmaWxlKHBhdGg6IHN0cmluZywgZmlsZXBhdGg6IHN0cmluZywgLi4ubTogTWlkZGxld2FyZUZ1bmNbXSk6IEFwcGxpY2F0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5nZXQocGF0aCwgKGMpID0+IGMuZmlsZShmaWxlcGF0aCksIC4uLm0pO1xuICB9XG5cbiAgI3RyYW5zZm9ybVJlc3VsdCA9IGFzeW5jIChjOiBDb250ZXh0LCBoOiBIYW5kbGVyRnVuYyk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIGxldCByZXN1bHQ6IHVua25vd247XG4gICAgdHJ5IHtcbiAgICAgIHJlc3VsdCA9IGF3YWl0IGgoYyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBIdHRwRXhjZXB0aW9uKSB7XG4gICAgICAgIHJlc3VsdCA9IGMuanNvbihcbiAgICAgICAgICB0eXBlb2YgZS5yZXNwb25zZSA9PT0gXCJvYmplY3RcIlxuICAgICAgICAgICAgPyBlLnJlc3BvbnNlXG4gICAgICAgICAgICA6IGNyZWF0ZUh0dHBFeGNlcHRpb25Cb2R5KGUucmVzcG9uc2UsIHVuZGVmaW5lZCwgZS5zdGF0dXMpLFxuICAgICAgICAgIGUuc3RhdHVzLFxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coZSk7XG4gICAgICAgIGUgPSBuZXcgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbihlLm1lc3NhZ2UpO1xuICAgICAgICByZXN1bHQgPSBjLmpzb24oXG4gICAgICAgICAgKGUgYXMgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbikucmVzcG9uc2UsXG4gICAgICAgICAgKGUgYXMgSW50ZXJuYWxTZXJ2ZXJFcnJvckV4Y2VwdGlvbikuc3RhdHVzLFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYy5yZXNwb25zZS5zdGF0dXMgPT0gdW5kZWZpbmVkKSB7XG4gICAgICBzd2l0Y2ggKHR5cGVvZiByZXN1bHQpIHtcbiAgICAgICAgY2FzZSBcIm9iamVjdFwiOlxuICAgICAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgICAgICBjLmJsb2IocmVzdWx0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYy5qc29uKHJlc3VsdCBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwic3RyaW5nXCI6XG4gICAgICAgICAgL15cXHMqPC8udGVzdChyZXN1bHQpID8gYy5odG1sKHJlc3VsdCkgOiBjLnN0cmluZyhyZXN1bHQpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGMuc3RyaW5nKFN0cmluZyhyZXN1bHQpKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBT0EsTUFBTSxHQUFHLEtBQUssRUFBRSxRQUFRLFFBQVEsQ0FBNkM7QUFDN0UsTUFBTSxHQUFHLElBQUksUUFBUSxDQUEwQztBQUMvRCxNQUFNLEdBQUcsTUFBTSxRQUFRLENBQTRDO0FBQ25FLE1BQU0sR0FBRyxPQUFPLFFBQVEsQ0FBYztBQUN0QyxNQUFNLEdBQUcsTUFBTSxRQUFRLENBQWE7QUFDcEMsTUFBTSxHQUFHLEtBQUssUUFBUSxDQUFZO0FBQ2xDLE1BQU0sR0FDSix1QkFBdUIsRUFD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