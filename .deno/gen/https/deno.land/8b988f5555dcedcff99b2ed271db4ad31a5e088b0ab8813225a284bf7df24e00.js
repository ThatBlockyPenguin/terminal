import { Status } from "./vendor/https/deno.land/std/http/http_status.ts";
import { join } from "./vendor/https/deno.land/std/path/mod.ts";
import { getCookies, setCookie } from "./vendor/https/deno.land/std/http/cookie.ts";
import { MultipartReader } from "./vendor/https/deno.land/std/mime/multipart.ts";
import { Header, MIME } from "./constants.ts";
import { contentType, NotFoundHandler } from "./util.ts";
const { cwd , readFile , readAll  } = Deno;
const encoder = new TextEncoder();
const decoder = new TextDecoder();
export class Context {
    app;
    request;
    url;
    response = {
        headers: new Headers()
    };
    params = {
    };
    customContext;
    #store;
    #body;
    get cookies() {
        return getCookies(this.request);
    }
    get path() {
        return this.url.pathname;
    }
    get method() {
        return this.request.method;
    }
    get queryParams() {
        const params = {
        };
        for (const [k, v] of this.url.searchParams){
            params[k] = v;
        }
        return params;
    }
    get body() {
        return this.#body ?? (this.#body = this.#readBody());
    }
    get(key) {
        return this.#store?.get(key);
    }
    set(key, val) {
        if (this.#store === undefined) {
            this.#store = new Map();
        }
        this.#store.set(key, val);
    }
    constructor(optionsOrContext){
        if (optionsOrContext instanceof Context) {
            Object.assign(this, optionsOrContext);
            this.customContext = this;
            return;
        }
        const opts = optionsOrContext;
        this.app = opts.app;
        this.request = opts.r;
        this.url = new URL(this.request.url, `http://0.0.0.0`);
    }
    #writeContentType = (v)=>{
        if (!this.response.headers.has(Header.ContentType)) {
            this.response.headers.set(Header.ContentType, v);
        }
    };
    #readBody = async ()=>{
        const contentType = this.request.headers.get(Header.ContentType);
        walk: {
            let data = {
            };
            if (contentType) {
                if (contentType.includes(MIME.ApplicationJSON)) {
                    data = JSON.parse(decoder.decode(await readAll(this.request.body)));
                } else if (contentType.includes(MIME.ApplicationForm)) {
                    for (const [k, v] of new URLSearchParams(decoder.decode(await readAll(this.request.body)))){
                        data[k] = v;
                    }
                } else if (contentType.includes(MIME.MultipartForm)) {
                    const match = contentType.match(/boundary=([^\s]+)/);
                    const boundary = match ? match[1] : undefined;
                    if (boundary) {
                        const mr = new MultipartReader(this.request.body, boundary);
                        const form = await mr.readForm();
                        for (const [k, v] of form.entries()){
                            data[k] = v;
                        }
                    }
                } else {
                    break walk;
                }
            } else {
                break walk;
            }
            return data;
        }
        return decoder.decode(await readAll(this.request.body));
    };
    string(v, code = Status.OK) {
        this.#writeContentType(MIME.TextPlainCharsetUTF8);
        this.response.status = code;
        this.response.body = encoder.encode(v);
    }
    json(v, code = Status.OK) {
        this.#writeContentType(MIME.ApplicationJSONCharsetUTF8);
        this.response.status = code;
        this.response.body = encoder.encode(typeof v === "object" ? JSON.stringify(v) : v);
    }
    /** Sends an HTTP response with status code. */ html(v, code = Status.OK) {
        this.#writeContentType(MIME.TextHTMLCharsetUTF8);
        this.response.status = code;
        this.response.body = encoder.encode(v);
    }
    /** Sends an HTTP blob response with status code. */ htmlBlob(b, code = Status.OK) {
        this.blob(b, MIME.TextHTMLCharsetUTF8, code);
    }
    /**
   * Renders a template with data and sends a text/html response with status code.
   * renderer must be registered first.
   */ async render(name, data = {
    }, code = Status.OK) {
        if (!this.app.renderer) {
            throw new Error();
        }
        const r = await this.app.renderer.render(name, data);
        this.htmlBlob(r, code);
    }
    /** Sends a blob response with content type and status code. */ blob(b, contentType, code = Status.OK) {
        if (contentType) {
            this.#writeContentType(contentType);
        }
        this.response.status = code;
        this.response.body = b;
    }
    async file(filepath) {
        filepath = join(cwd(), filepath);
        try {
            this.blob(await readFile(filepath), contentType(filepath));
        } catch  {
            NotFoundHandler();
        }
    }
    /** append a `Set-Cookie` header to the response */ setCookie(c) {
        setCookie(this.response, c);
    }
    /** Redirects a response to a specific URL. the `code` defaults to `302` if omitted */ redirect(url, code = Status.Found) {
        this.response.headers.set(Header.Location, url);
        this.response.status = code;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvYWJjQHYxLjMuMy9jb250ZXh0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHtcbiAgUmVzcG9uc2UsXG4gIFNlcnZlclJlcXVlc3QsXG59IGZyb20gXCIuL3ZlbmRvci9odHRwcy9kZW5vLmxhbmQvc3RkL2h0dHAvc2VydmVyLnRzXCI7XG5pbXBvcnQgdHlwZSB7IENvb2tpZSB9IGZyb20gXCIuL3ZlbmRvci9odHRwcy9kZW5vLmxhbmQvc3RkL2h0dHAvY29va2llLnRzXCI7XG5pbXBvcnQgdHlwZSB7IEFwcGxpY2F0aW9uIH0gZnJvbSBcIi4vYXBwLnRzXCI7XG5pbXBvcnQgdHlwZSB7IENvbnRleHRPcHRpb25zIH0gZnJvbSBcIi4vdHlwZXMudHNcIjtcblxuaW1wb3J0IHsgU3RhdHVzIH0gZnJvbSBcIi4vdmVuZG9yL2h0dHBzL2Rlbm8ubGFuZC9zdGQvaHR0cC9odHRwX3N0YXR1cy50c1wiO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gXCIuL3ZlbmRvci9odHRwcy9kZW5vLmxhbmQvc3RkL3BhdGgvbW9kLnRzXCI7XG5pbXBvcnQge1xuICBnZXRDb29raWVzLFxuICBzZXRDb29raWUsXG59IGZyb20gXCIuL3ZlbmRvci9odHRwcy9kZW5vLmxhbmQvc3RkL2h0dHAvY29va2llLnRzXCI7XG5pbXBvcnQgeyBNdWx0aXBhcnRSZWFkZXIgfSBmcm9tIFwiLi92ZW5kb3IvaHR0cHMvZGVuby5sYW5kL3N0ZC9taW1lL211bHRpcGFydC50c1wiO1xuaW1wb3J0IHsgSGVhZGVyLCBNSU1FIH0gZnJvbSBcIi4vY29uc3RhbnRzLnRzXCI7XG5pbXBvcnQgeyBjb250ZW50VHlwZSwgTm90Rm91bmRIYW5kbGVyIH0gZnJvbSBcIi4vdXRpbC50c1wiO1xuXG5jb25zdCB7IGN3ZCwgcmVhZEZpbGUsIHJlYWRBbGwgfSA9IERlbm87XG5cbmNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbmNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcblxuZXhwb3J0IGNsYXNzIENvbnRleHQge1xuICBhcHAhOiBBcHBsaWNhdGlvbjtcbiAgcmVxdWVzdCE6IFNlcnZlclJlcXVlc3Q7XG4gIHVybCE6IFVSTDtcblxuICByZXNwb25zZTogUmVzcG9uc2UgJiB7IGhlYWRlcnM6IEhlYWRlcnMgfSA9IHsgaGVhZGVyczogbmV3IEhlYWRlcnMoKSB9O1xuICBwYXJhbXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgY3VzdG9tQ29udGV4dDogYW55O1xuXG4gICNzdG9yZT86IE1hcDxzdHJpbmcgfCBzeW1ib2wsIHVua25vd24+O1xuXG4gICNib2R5OiBQcm9taXNlPHVua25vd24+IHwgdW5kZWZpbmVkO1xuXG4gIGdldCBjb29raWVzKCk6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4ge1xuICAgIHJldHVybiBnZXRDb29raWVzKHRoaXMucmVxdWVzdCk7XG4gIH1cblxuICBnZXQgcGF0aCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnVybC5wYXRobmFtZTtcbiAgfVxuXG4gIGdldCBtZXRob2QoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0Lm1ldGhvZDtcbiAgfVxuXG4gIGdldCBxdWVyeVBhcmFtcygpOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IHtcbiAgICBjb25zdCBwYXJhbXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fTtcbiAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiB0aGlzLnVybC5zZWFyY2hQYXJhbXMpIHtcbiAgICAgIHBhcmFtc1trXSA9IHY7XG4gICAgfVxuICAgIHJldHVybiBwYXJhbXM7XG4gIH1cblxuICBnZXQgYm9keSgpOiBQcm9taXNlPHVua25vd24+IHtcbiAgICByZXR1cm4gdGhpcy4jYm9keSA/PyAodGhpcy4jYm9keSA9IHRoaXMuI3JlYWRCb2R5KCkpO1xuICB9XG5cbiAgZ2V0KGtleTogc3RyaW5nIHwgc3ltYm9sKTogdW5rbm93biB7XG4gICAgcmV0dXJuIHRoaXMuI3N0b3JlPy5nZXQoa2V5KTtcbiAgfVxuXG4gIHNldChrZXk6IHN0cmluZyB8IHN5bWJvbCwgdmFsOiB1bmtub3duKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuI3N0b3JlID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuI3N0b3JlID0gbmV3IE1hcCgpO1xuICAgIH1cblxuICAgIHRoaXMuI3N0b3JlLnNldChrZXksIHZhbCk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihvcHRzOiBDb250ZXh0T3B0aW9ucyk7XG4gIGNvbnN0cnVjdG9yKGM6IENvbnRleHQpO1xuICBjb25zdHJ1Y3RvcihvcHRpb25zT3JDb250ZXh0OiBDb250ZXh0T3B0aW9ucyB8IENvbnRleHQpIHtcbiAgICBpZiAob3B0aW9uc09yQ29udGV4dCBpbnN0YW5jZW9mIENvbnRleHQpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgb3B0aW9uc09yQ29udGV4dCk7XG4gICAgICB0aGlzLmN1c3RvbUNvbnRleHQgPSB0aGlzO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IG9wdHMgPSBvcHRpb25zT3JDb250ZXh0O1xuICAgIHRoaXMuYXBwID0gb3B0cy5hcHA7XG4gICAgdGhpcy5yZXF1ZXN0ID0gb3B0cy5yO1xuXG4gICAgdGhpcy51cmwgPSBuZXcgVVJMKHRoaXMucmVxdWVzdC51cmwsIGBodHRwOi8vMC4wLjAuMGApO1xuICB9XG5cbiAgI3dyaXRlQ29udGVudFR5cGUgPSAodjogc3RyaW5nKTogdm9pZCA9PiB7XG4gICAgaWYgKCF0aGlzLnJlc3BvbnNlLmhlYWRlcnMuaGFzKEhlYWRlci5Db250ZW50VHlwZSkpIHtcbiAgICAgIHRoaXMucmVzcG9uc2UuaGVhZGVycy5zZXQoSGVhZGVyLkNvbnRlbnRUeXBlLCB2KTtcbiAgICB9XG4gIH07XG5cbiAgI3JlYWRCb2R5ID0gYXN5bmMgKCk6IFByb21pc2U8dW5rbm93bj4gPT4ge1xuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5yZXF1ZXN0LmhlYWRlcnMuZ2V0KEhlYWRlci5Db250ZW50VHlwZSk7XG4gICAgd2Fsazoge1xuICAgICAgbGV0IGRhdGE6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG4gICAgICBpZiAoY29udGVudFR5cGUpIHtcbiAgICAgICAgaWYgKGNvbnRlbnRUeXBlLmluY2x1ZGVzKE1JTUUuQXBwbGljYXRpb25KU09OKSkge1xuICAgICAgICAgIGRhdGEgPSBKU09OLnBhcnNlKGRlY29kZXIuZGVjb2RlKGF3YWl0IHJlYWRBbGwodGhpcy5yZXF1ZXN0LmJvZHkpKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29udGVudFR5cGUuaW5jbHVkZXMoTUlNRS5BcHBsaWNhdGlvbkZvcm0pKSB7XG4gICAgICAgICAgZm9yIChcbiAgICAgICAgICAgIGNvbnN0IFtrLCB2XSBvZiBuZXcgVVJMU2VhcmNoUGFyYW1zKFxuICAgICAgICAgICAgICBkZWNvZGVyLmRlY29kZShhd2FpdCByZWFkQWxsKHRoaXMucmVxdWVzdC5ib2R5KSksXG4gICAgICAgICAgICApXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBkYXRhW2tdID0gdjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoY29udGVudFR5cGUuaW5jbHVkZXMoTUlNRS5NdWx0aXBhcnRGb3JtKSkge1xuICAgICAgICAgIGNvbnN0IG1hdGNoID0gY29udGVudFR5cGUubWF0Y2goL2JvdW5kYXJ5PShbXlxcc10rKS8pO1xuICAgICAgICAgIGNvbnN0IGJvdW5kYXJ5ID0gbWF0Y2ggPyBtYXRjaFsxXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICBpZiAoYm91bmRhcnkpIHtcbiAgICAgICAgICAgIGNvbnN0IG1yID0gbmV3IE11bHRpcGFydFJlYWRlcih0aGlzLnJlcXVlc3QuYm9keSwgYm91bmRhcnkpO1xuICAgICAgICAgICAgY29uc3QgZm9ybSA9IGF3YWl0IG1yLnJlYWRGb3JtKCk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiBmb3JtLmVudHJpZXMoKSkge1xuICAgICAgICAgICAgICBkYXRhW2tdID0gdjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYnJlYWsgd2FsaztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnJlYWsgd2FsaztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRlY29kZXIuZGVjb2RlKGF3YWl0IHJlYWRBbGwodGhpcy5yZXF1ZXN0LmJvZHkpKTtcbiAgfTtcblxuICBzdHJpbmcodjogc3RyaW5nLCBjb2RlOiBTdGF0dXMgPSBTdGF0dXMuT0spOiB2b2lkIHtcbiAgICB0aGlzLiN3cml0ZUNvbnRlbnRUeXBlKE1JTUUuVGV4dFBsYWluQ2hhcnNldFVURjgpO1xuICAgIHRoaXMucmVzcG9uc2Uuc3RhdHVzID0gY29kZTtcbiAgICB0aGlzLnJlc3BvbnNlLmJvZHkgPSBlbmNvZGVyLmVuY29kZSh2KTtcbiAgfVxuXG4gIGpzb24odjogUmVjb3JkPHN0cmluZywgYW55PiB8IHN0cmluZywgY29kZTogU3RhdHVzID0gU3RhdHVzLk9LKTogdm9pZCB7XG4gICAgdGhpcy4jd3JpdGVDb250ZW50VHlwZShNSU1FLkFwcGxpY2F0aW9uSlNPTkNoYXJzZXRVVEY4KTtcbiAgICB0aGlzLnJlc3BvbnNlLnN0YXR1cyA9IGNvZGU7XG4gICAgdGhpcy5yZXNwb25zZS5ib2R5ID0gZW5jb2Rlci5lbmNvZGUoXG4gICAgICB0eXBlb2YgdiA9PT0gXCJvYmplY3RcIiA/IEpTT04uc3RyaW5naWZ5KHYpIDogdixcbiAgICApO1xuICB9XG5cbiAgLyoqIFNlbmRzIGFuIEhUVFAgcmVzcG9uc2Ugd2l0aCBzdGF0dXMgY29kZS4gKi9cbiAgaHRtbCh2OiBzdHJpbmcsIGNvZGU6IFN0YXR1cyA9IFN0YXR1cy5PSyk6IHZvaWQge1xuICAgIHRoaXMuI3dyaXRlQ29udGVudFR5cGUoTUlNRS5UZXh0SFRNTENoYXJzZXRVVEY4KTtcbiAgICB0aGlzLnJlc3BvbnNlLnN0YXR1cyA9IGNvZGU7XG4gICAgdGhpcy5yZXNwb25zZS5ib2R5ID0gZW5jb2Rlci5lbmNvZGUodik7XG4gIH1cblxuICAvKiogU2VuZHMgYW4gSFRUUCBibG9iIHJlc3BvbnNlIHdpdGggc3RhdHVzIGNvZGUuICovXG4gIGh0bWxCbG9iKGI6IFVpbnQ4QXJyYXkgfCBEZW5vLlJlYWRlciwgY29kZTogU3RhdHVzID0gU3RhdHVzLk9LKTogdm9pZCB7XG4gICAgdGhpcy5ibG9iKGIsIE1JTUUuVGV4dEhUTUxDaGFyc2V0VVRGOCwgY29kZSk7XG4gIH1cblxuICAvKipcbiAgICogUmVuZGVycyBhIHRlbXBsYXRlIHdpdGggZGF0YSBhbmQgc2VuZHMgYSB0ZXh0L2h0bWwgcmVzcG9uc2Ugd2l0aCBzdGF0dXMgY29kZS5cbiAgICogcmVuZGVyZXIgbXVzdCBiZSByZWdpc3RlcmVkIGZpcnN0LlxuICAgKi9cbiAgYXN5bmMgcmVuZGVyPFQ+KFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICBkYXRhOiBUID0ge30gYXMgVCxcbiAgICBjb2RlOiBTdGF0dXMgPSBTdGF0dXMuT0ssXG4gICk6IFByb21pc2U8dm9pZD4ge1xuICAgIGlmICghdGhpcy5hcHAucmVuZGVyZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgIH1cbiAgICBjb25zdCByID0gYXdhaXQgdGhpcy5hcHAucmVuZGVyZXIucmVuZGVyKG5hbWUsIGRhdGEpO1xuICAgIHRoaXMuaHRtbEJsb2IociwgY29kZSk7XG4gIH1cblxuICAvKiogU2VuZHMgYSBibG9iIHJlc3BvbnNlIHdpdGggY29udGVudCB0eXBlIGFuZCBzdGF0dXMgY29kZS4gKi9cbiAgYmxvYihcbiAgICBiOiBVaW50OEFycmF5IHwgRGVuby5SZWFkZXIsXG4gICAgY29udGVudFR5cGU/OiBzdHJpbmcsXG4gICAgY29kZTogU3RhdHVzID0gU3RhdHVzLk9LLFxuICApOiB2b2lkIHtcbiAgICBpZiAoY29udGVudFR5cGUpIHtcbiAgICAgIHRoaXMuI3dyaXRlQ29udGVudFR5cGUoY29udGVudFR5cGUpO1xuICAgIH1cbiAgICB0aGlzLnJlc3BvbnNlLnN0YXR1cyA9IGNvZGU7XG4gICAgdGhpcy5yZXNwb25zZS5ib2R5ID0gYjtcbiAgfVxuXG4gIGFzeW5jIGZpbGUoZmlsZXBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGZpbGVwYXRoID0gam9pbihjd2QoKSwgZmlsZXBhdGgpO1xuICAgIHRyeSB7XG4gICAgICB0aGlzLmJsb2IoYXdhaXQgcmVhZEZpbGUoZmlsZXBhdGgpLCBjb250ZW50VHlwZShmaWxlcGF0aCkpO1xuICAgIH0gY2F0Y2gge1xuICAgICAgTm90Rm91bmRIYW5kbGVyKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqIGFwcGVuZCBhIGBTZXQtQ29va2llYCBoZWFkZXIgdG8gdGhlIHJlc3BvbnNlICovXG4gIHNldENvb2tpZShjOiBDb29raWUpOiB2b2lkIHtcbiAgICBzZXRDb29raWUodGhpcy5yZXNwb25zZSwgYyk7XG4gIH1cblxuICAvKiogUmVkaXJlY3RzIGEgcmVzcG9uc2UgdG8gYSBzcGVjaWZpYyBVUkwuIHRoZSBgY29kZWAgZGVmYXVsdHMgdG8gYDMwMmAgaWYgb21pdHRlZCAqL1xuICByZWRpcmVjdCh1cmw6IHN0cmluZywgY29kZSA9IFN0YXR1cy5Gb3VuZCk6IHZvaWQge1xuICAgIHRoaXMucmVzcG9uc2UuaGVhZGVycy5zZXQoSGVhZGVyLkxvY2F0aW9uLCB1cmwpO1xuICAgIHRoaXMucmVzcG9uc2Uuc3RhdHVzID0gY29kZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVFBLE1BQU0sR0FBRyxNQUFNLFFBQVEsQ0FBa0Q7QUFDekUsTUFBTSxHQUFHLElBQUksUUFBUSxDQUEwQztBQUMvRCxNQUFNLEdBQ0osVUFBVSxFQUNWLFNBQVMsUUFDSixDQUE2QztBQUNwRCxNQUFNLEdBQUcsZUFBZSxRQUFRLENBQWdEO0FBQ2hGLE1B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